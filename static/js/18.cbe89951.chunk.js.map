{"version":3,"sources":["pages/verify.js"],"names":["VerifyEmail","useContext","AuthContext","user_email","auth_token","email","user_email_verified","setEmailAsVerified","useState","stage","setStage","code","setCode","disabled","setDisabled","to","className","type","onClick","console","log","Axios","post","getApiLink","xAuthToken","then","res","data","catch","e","response","href","style","color","placeholder","width","fontSize","fontWeight","value","onChange","target","success","Notyf","error","message","length","role","aria-label","as"],"mappings":"gNAgLeA,UAzKK,WAAO,IAAD,EAOpBC,qBAAWC,KALbC,EAFsB,EAEtBA,WACAC,EAHsB,EAGtBA,WACAC,EAJsB,EAItBA,MACAC,EALsB,EAKtBA,oBACAC,EANsB,EAMtBA,mBANsB,EAQEC,mBAAS,GARX,mBAQjBC,EARiB,KAQVC,EARU,OASAF,mBAAS,IATT,mBASjBG,EATiB,KASXC,EATW,OAUQJ,oBAAS,GAVjB,mBAUjBK,EAViB,KAUPC,EAVO,KAmDxB,OACE,oCACa,IAAVL,GAAuC,IAAxBH,GAA6B,kBAAC,IAAD,CAAUS,GAAG,MAC1D,yBAAKC,UAAU,aACb,yBAAKA,UAAU,OACb,yBAAKA,UAAU,aACf,yBAAKA,UAAU,wBACb,yBAAKA,UAAU,gBACb,yBAAKA,UAAU,WACF,IAAVP,GACC,oCACE,yDACA,6GAOO,IAAVA,GACC,oCACE,4BACEO,UAAU,mCACVC,KAAK,SACLC,QAAS,WACPR,EAAS,GACTS,QAAQC,IAAI,WAhEhCC,IAAMC,KAAN,UAAcC,cAAd,iCAA2D,CACzDC,WAAYpB,EACZC,MAAOF,IAENsB,MAAK,SAACC,GACLP,QAAQC,IAAIM,EAAIC,SAEjBC,OAAM,SAACC,GACNV,QAAQC,IAAIS,EAAEC,UACdpB,EAAS,OA0DKG,SAAUA,GARZ,4BAYA,6BACA,uBACEkB,KAAK,cACLf,UAAU,QACVgB,MAAO,CAAEC,MAAO,WAChBf,QAAS,WACPR,EAAS,KALb,6BAaO,IAAVD,GACC,oCACE,2BACEQ,KAAK,OACLD,UAAU,0DACVkB,YAAY,iBACZF,MAAO,CACLG,MAAO,QACPC,SAAU,OACVC,WAAY,OAEdC,MAAO3B,EACP4B,SAAU,SAACV,GACTjB,EAAQiB,EAAEW,OAAOF,UAGrB,4BACEtB,UAAU,4BACVC,KAAK,SACLC,QAAS,WACPJ,GAAY,GA3FhCO,IAAMC,KAAN,UAAcC,cAAd,uBAAiD,CAC/CC,WAAYpB,EACZO,SAECc,MAAK,SAACC,GACLP,QAAQC,IAAIM,EAAIC,MAChBjB,EAAS,GACLgB,EAAIC,KAAKc,SACXlC,IACAmC,IAAMD,QAAQ,kCAEdC,IAAMC,MAAMjB,EAAIC,KAAKiB,YAGxBhB,OAAM,SAACC,GACNV,QAAQC,IAAI,CAAES,MACVA,EAAEC,WACJlB,EAAQ,IACR8B,IAAMC,MAAMd,EAAEC,SAASH,KAAKgB,MAAMC,UAEpC9B,GAAY,OA0EED,WACIF,EAAKkC,OAAS,GAAKlC,EAAKkC,OAAS,KAAOhC,GAR9C,WAaA,6BACA,uBACEkB,KAAK,UACLf,UAAU,QACVgB,MAAO,CAAEC,MAAO,WAChBf,QAAS,WACPR,EAAS,KALb,iCAaO,IAAVD,GACC,oCACE,+CACwB,IACtB,0BAAMqC,KAAK,MAAMC,aAAW,SAA5B,iBAIF,uBAAG/B,UAAU,QAAb,yCACyCX,EADzC,wEAKA,kBAAC,IAAD,CAAMU,GAAG,IAAIC,UAAU,kBAAkBgC,GAAG,UAA5C,uBAQV,yBAAKhC,UAAU","file":"static/js/18.cbe89951.chunk.js","sourcesContent":["import React, { useContext, useState } from 'react';\r\nimport Axios from 'axios';\r\nimport { Redirect, Link } from 'react-router-dom';\r\nimport { AuthContext } from '../contexts/auth_context';\r\nimport { getApiLink } from '../lib/env.lib';\r\nimport Notyf from '../lib/notification';\r\n\r\nconst VerifyEmail = () => {\r\n  const {\r\n    user_email,\r\n    auth_token,\r\n    email,\r\n    user_email_verified,\r\n    setEmailAsVerified,\r\n  } = useContext(AuthContext);\r\n  const [stage, setStage] = useState(0);\r\n  const [code, setCode] = useState('');\r\n  const [disabled, setDisabled] = useState(false);\r\n\r\n  function requestVerificationEmail() {\r\n    Axios.post(`${getApiLink()}/api/v1/sendVerificationEmail`, {\r\n      xAuthToken: auth_token,\r\n      email: user_email,\r\n    })\r\n      .then((res) => {\r\n        console.log(res.data);\r\n      })\r\n      .catch((e) => {\r\n        console.log(e.response);\r\n        setStage(0);\r\n      });\r\n  }\r\n\r\n  function verifyEmail() {\r\n    Axios.post(`${getApiLink()}/api/v1/verifyEmail`, {\r\n      xAuthToken: auth_token,\r\n      code,\r\n    })\r\n      .then((res) => {\r\n        console.log(res.data);\r\n        setStage(2);\r\n        if (res.data.success) {\r\n          setEmailAsVerified();\r\n          Notyf.success('Your account is now verified.');\r\n        } else {\r\n          Notyf.error(res.data.message);\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        console.log({ e });\r\n        if (e.response) {\r\n          setCode('');\r\n          Notyf.error(e.response.data.error.message);\r\n        }\r\n        setDisabled(false);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {stage !== 2 && user_email_verified === 1 && <Redirect to=\"/\" />}\r\n      <div className=\"container\">\r\n        <div className=\"row\">\r\n          <div className=\"col-lg-3\" />\r\n          <div className=\"col-lg-6 text-center\">\r\n            <div className=\"custom-card2\">\r\n              <div className=\"p-4 m-4\">\r\n                {stage !== 2 && (\r\n                  <>\r\n                    <h4>Verify your email address</h4>\r\n                    <p>\r\n                      You are almost done! A Verification code has been sent to\r\n                      your email address.\r\n                    </p>\r\n                  </>\r\n                )}\r\n\r\n                {stage === 0 && (\r\n                  <>\r\n                    <button\r\n                      className=\"btn btn-primary btn-lg mt-2 mb-4\"\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setStage(1);\r\n                        console.log('clicked');\r\n                        requestVerificationEmail();\r\n                      }}\r\n                      disabled={disabled}\r\n                    >\r\n                      Resend verification code\r\n                    </button>\r\n                    <br />\r\n                    <a\r\n                      href=\"#enter-code\"\r\n                      className=\"small\"\r\n                      style={{ color: 'inherit' }}\r\n                      onClick={() => {\r\n                        setStage(1);\r\n                      }}\r\n                    >\r\n                      I already have the code.\r\n                    </a>\r\n                  </>\r\n                )}\r\n\r\n                {stage === 1 && (\r\n                  <>\r\n                    <input\r\n                      type=\"text\"\r\n                      className=\"form-control text-uppercase mr-auto ml-auto text-center\"\r\n                      placeholder=\"Enter the code\"\r\n                      style={{\r\n                        width: '250px',\r\n                        fontSize: '20px',\r\n                        fontWeight: '600',\r\n                      }}\r\n                      value={code}\r\n                      onChange={(e) => {\r\n                        setCode(e.target.value);\r\n                      }}\r\n                    />\r\n                    <button\r\n                      className=\"btn btn-primary mt-3 mb-4\"\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setDisabled(true);\r\n                        verifyEmail();\r\n                      }}\r\n                      disabled={\r\n                        !(code.length > 0 && code.length < 10) && disabled\r\n                      }\r\n                    >\r\n                      Verify!\r\n                    </button>\r\n                    <br />\r\n                    <a\r\n                      href=\"#verify\"\r\n                      className=\"small\"\r\n                      style={{ color: 'inherit' }}\r\n                      onClick={() => {\r\n                        setStage(0);\r\n                      }}\r\n                    >\r\n                      Oops! I don&apos;t have the code.\r\n                    </a>\r\n                  </>\r\n                )}\r\n\r\n                {stage === 2 && (\r\n                  <>\r\n                    <h3>\r\n                      You&apos;re verified!{' '}\r\n                      <span role=\"img\" aria-label=\"emoji\">\r\n                        ðŸ¥³\r\n                      </span>\r\n                    </h3>\r\n                    <p className=\"mt-3\">\r\n                      Nice one! We were able to verify that {email} is your real\r\n                      email address and you are, in fact, NOT a robot. Whew!\r\n                    </p>\r\n\r\n                    <Link to=\"/\" className=\"btn btn-primary\" as=\"button\">\r\n                      Go to Home page\r\n                    </Link>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"col-lg-3\" />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default VerifyEmail;\r\n"],"sourceRoot":""}